{% extends "layout.html" %}
{% block content %}
<!-- include profile.css -->
<link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">

<div class="container rounded bg-white mt-5 mb-5">
    <div class="row">
        <div class="col-md-4 border-right">
            <div class="d-flex flex-column align-items-center text-center p-3 py-5">
                <img class="rounded-circle mt-5" width="150px" src={{ current_user.avatar_url }}>
                <span class="font-weight-bold">
                    {{ current_user.name }}
                </span>
                <span class="font-weight-bold text-black-50">
                    <a href="{{ current_user.git_url }}">Visit GitHub Profile</a>
                </span>
                <br> <br>
                <hr style="width: 80%; color: black; height: 1px; background-color:black;">
                <!-- Add a line to differnetiatie -->
                <span> </span>
                <!-- The font size has to be big -->
                <div class="container">
                <span class="font-weight-bold text-black-50 text-center" style="font-size: 32px;">
                    Profile Stats:
                </span>
                <br>
                <span class="font-weight-bold text-black-50" style="font-size: 18px; text-align: left;">
                    Overall Score: {{ "%.3f"|format(current_user.overallscore) }}
                </span>
                <br>
                <span class="font-weight-bold text-black-50"style="font-size: 18px; text-align: left;">
                    Number of Attempts: {{ current_user.Nattempts }}
                </span>
                <br>
                <span class="font-weight-bold text-black-50" style="font-size: 18px; text-align: left;">
                    Q1 Best Score: {{ "%.3f"|format(current_user.q1_bestscore) }}
                </span>
                <br>
                <span class="font-weight-bold text-black-50" style="font-size: 18px; text-align: left;">
                    Q1 attempts: {{ current_user.q1_attempts }}
                </span>
                <br>
                <span class="font-weight-bold text-black-50" style="font-size: 18px; text-align: left;">
                    Q2 Best Score: {{ "%.3f"|format(current_user.q2_bestscore) }}
                </span>
                <br>
                <span class="font-weight-bold text-black-50" style="font-size: 18px; text-align: left;">
                    Q2 attempts: {{ current_user.q2_attempts }}
                </span>
                
                </div>
                <span> </span>
                <hr style="width: 80%; color: black; height: 1px; background-color:black;">
            </div>
        </div>
        <div class="col-md-7 border-right">
            <div class="p-3 py-5">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h4 class="text-right">Profile Settings</h4>
                </div>
                <div class="content-section">
                    <form method="POST" action="">
                        {{ form.csrf_token }}
                        <fieldset class="form-group blackcolor">
                            <div class="row mt-2">
                                <div class="col-md-6 form-group">
                                    {{ form.fname.label(class="form-control-label") }}
                                    {% if form.fname.errors %}
                                    {{ form.fname(class="form-control form-control-lg is-invalid") }}
                                    <div class="invalid-feedback">
                                        {% for error in form.fname.errors %}
                                        <span>{{ error }}</span>
                                        {% endfor %}
                                    </div>
                                    {% else %}
                                    {{ form.fname(class="form-control form-control-lg") }}
                                    {% endif %} 
                                </div>
                                <div class="col-md-6 form-group">
                                    {{ form.lname.label(class="form-control-label") }}
                                    {% if form.lname.errors %}
                                    {{ form.lname(class="form-control form-control-lg is-invalid") }}
                                    <div class="invalid-feedback">
                                        {% for error in form.lname.errors %}
                                        <span>{{ error }}</span>
                                        {% endfor %}
                                    </div>
                                    {% else %}
                                    {{ form.lname(class="form-control form-control-lg") }}
                                    {% endif %}
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-12 form-group">
                                    {{ form.username.label(class="form-control-label") }}
                                    {% if form.username.errors %}
                                        {{ form.username(class="form-control form-control-lg is-invalid") }}
                                        <div class="invalid-feedback">
                                            {% for error in form.username.errors %}
                                                <span>{{ error }}</span>
                                            {% endfor %}
                                        </div>
                                    {% else %}
                                        {{ form.username(class="form-control form-control-lg") }}
                                    {% endif %}
                                </div>
                                <div class="col-md-12 form-group">
                                    {{ form.password.label(class="form-control-label") }}
                                    {% if form.password.errors %}
                                    {{ form.password(class="form-control form-control-lg is-invalid") }}
                                    <div class="invalid-feedback">
                                        {% for error in form.password.errors %}
                                        <span>{{ error }}</span>
                                        {% endfor %}
                                    </div>
                                    {% else %}
                                    {{ form.password(class="form-control form-control-lg") }}
                                    {% endif %}
                                </div>
                                <div class="col-md-12 form-group">
                                    {{ form.institution.label(class="form-control-label") }}
                                    {% if form.institution.errors %}
                                    {{ form.institution(class="form-control form-control-lg is-invalid") }}
                                    <div class="invalid-feedback">
                                        {% for error in form.institution.errors %}
                                        <span>{{ error }}</span>
                                        {% endfor %}
                                    </div>
                                    {% else %}
                                    {{ form.institution(class="form-control form-control-lg") }}
                                    {% endif %}
                                </div>
                                <div class="col-md-12 form-group">
                                    {{ form.role.label(class="form-control-label") }}
                                    {% if form.role.errors %}
                                    {{ form.role(class="form-control form-control-lg is-invalid") }}
                                    <div class="invalid-feedback">
                                        {% for error in form.role.errors %}
                                        <span>{{ error }}</span>
                                        {% endfor %}
                                    </div>
                                    {% else %}
                                    {{ form.role(class="form-control form-control-lg") }}
                                    {% endif %}
                                </div> 
                            </div>
                        </fieldset>
                        
                        <div class="mt-5 text-center form-group">
                            {{ form.submit(class="btn btn-outline-info") }}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<br> <br>

<hr class="rounded" style="width: 100%; color: white; height: 1vw; background-color:white;">

<br> <br>

<!--- Now tabulate all questions with score submittime remarks evaluated remarks as columns-->
{% if submissions %}
<table border="1" style="width:95%; text-align:left; align:center; font-size: 18px; color: white;">
    <thead>
        <tr>
            <th> Question Number </th>
            <th> Score </th>
            <th> Submission Time </th>
            <th> Remarks </th>
            <th> Evaluated Remarks </th>
        </tr>
    </thead>
    <tbody>
        {% for submission in submissions %}
        <tr>
            <td> {{ submission.qnumber }} </td>
            <td> {{ "%.3f"|format(submission.qscore) }} </td>
            <td> {{ submission.submit_time }} </td>
            <td> {{ submission.remarks }} </td>
            <td> {{ submission.eval_remarks }} </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<h3 style="color: white;"> Your submissions will appear here</h3>
{% endif %}
{% endblock content %}